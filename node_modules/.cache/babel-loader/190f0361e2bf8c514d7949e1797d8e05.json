{"ast":null,"code":"import _slicedToArray from \"/Users/furkandemirturk/Desktop/merng-client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";\nvar _jsxFileName = \"/Users/furkandemirturk/Desktop/merng-client/src/components/DeleteButton.js\";\nimport React, { useState } from 'react';\nimport gql from 'graphql-tag';\nimport { useMutation } from '@apollo/react-hooks';\nimport { Button, Confirm, Icon, Popup } from 'semantic-ui-react';\nimport { FETCH_POSTS_QUERY } from '../util/graphql';\n\nfunction DeleteButton({\n  postId,\n  commentId,\n  callback\n}) {\n  const _useState = useState(false),\n        _useState2 = _slicedToArray(_useState, 2),\n        confirmOpen = _useState2[0],\n        setConfirmOpen = _useState2[1];\n\n  const mutation = commentId ? DELETE_COMMENT_MUTATION : DELETE_POST_MUTATION;\n\n  const _useMutation = useMutation(mutation, {\n    update(proxy) {\n      setConfirmOpen(false);\n\n      if (!commentId) {\n        const data = proxy.readQuery({\n          query: FETCH_POSTS_QUERY\n        });\n        proxy.writeQuery({\n          query: FETCH_POSTS_QUERY,\n          data: {\n            getPosts: [...data.getPosts.filter(p => p.id !== postId)]\n          }\n        });\n        console.log(data.getPosts);\n      }\n\n      if (callback) callback();\n    },\n\n    variables: {\n      postId,\n      commentId\n    }\n  }),\n        _useMutation2 = _slicedToArray(_useMutation, 1),\n        deletePostOrMutation = _useMutation2[0];\n\n  return React.createElement(React.Fragment, null, React.createElement(Popup, {\n    content: commentId ? 'Delete comment' : 'Delete post ',\n    inverted: true,\n    trigger: React.createElement(Button, {\n      as: \"div\",\n      color: \"red\",\n      floated: \"right\",\n      onClick: () => setConfirmOpen(true),\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 31\n      },\n      __self: this\n    }, React.createElement(Icon, {\n      name: \"trash\",\n      style: {\n        margin: 0\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 32\n      },\n      __self: this\n    })),\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 30\n    },\n    __self: this\n  }), React.createElement(Confirm, {\n    open: confirmOpen,\n    onCancel: () => setConfirmOpen(false),\n    onConfirm: deletePostOrMutation,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 36\n    },\n    __self: this\n  }));\n}\n\nconst DELETE_POST_MUTATION = gql`\nmutation deletePost($postId : ID!){\n    deletePost(postId: $postId)\n}\n`;\nconst DELETE_COMMENT_MUTATION = gql`\nmutation deleteComment( $postId : ID!, $commentId: ID!){\n    deleteComment(postId : $postId , commentId : $commentId){\n        id\n        comments{\n            id username createdAt body\n        }\n        commentCount\n    }\n}\n`;\nexport default DeleteButton;","map":{"version":3,"sources":["/Users/furkandemirturk/Desktop/merng-client/src/components/DeleteButton.js"],"names":["React","useState","gql","useMutation","Button","Confirm","Icon","Popup","FETCH_POSTS_QUERY","DeleteButton","postId","commentId","callback","confirmOpen","setConfirmOpen","mutation","DELETE_COMMENT_MUTATION","DELETE_POST_MUTATION","update","proxy","data","readQuery","query","writeQuery","getPosts","filter","p","id","console","log","variables","deletePostOrMutation","margin"],"mappings":";;AAAA,OAAOA,KAAP,IAAeC,QAAf,QAA8B,OAA9B;AACA,OAAOC,GAAP,MAAgB,aAAhB;AACA,SAAQC,WAAR,QAA0B,qBAA1B;AACA,SAAQC,MAAR,EAAgBC,OAAhB,EAA0BC,IAA1B,EAAgCC,KAAhC,QAA4C,mBAA5C;AACA,SAAQC,iBAAR,QAAgC,iBAAhC;;AAEA,SAASC,YAAT,CAAsB;AAACC,EAAAA,MAAD;AAASC,EAAAA,SAAT;AAAoBC,EAAAA;AAApB,CAAtB,EAAoD;AAAA,oBACVX,QAAQ,CAAC,KAAD,CADE;AAAA;AAAA,QACzCY,WADyC;AAAA,QAC5BC,cAD4B;;AAEhD,QAAMC,QAAQ,GAAGJ,SAAS,GAAGK,uBAAH,GAA6BC,oBAAvD;;AAFgD,uBAGjBd,WAAW,CAACY,QAAD,EAAU;AAChDG,IAAAA,MAAM,CAACC,KAAD,EAAO;AACTL,MAAAA,cAAc,CAAC,KAAD,CAAd;;AACA,UAAG,CAACH,SAAJ,EAAe;AACX,cAAMS,IAAI,GAAGD,KAAK,CAACE,SAAN,CAAgB;AACzBC,UAAAA,KAAK,EAAGd;AADiB,SAAhB,CAAb;AAGAW,QAAAA,KAAK,CAACI,UAAN,CAAiB;AAACD,UAAAA,KAAK,EAAEd,iBAAR;AAA2BY,UAAAA,IAAI,EAAE;AAACI,YAAAA,QAAQ,EAAG,CAAC,GAAGJ,IAAI,CAACI,QAAL,CAAcC,MAAd,CAAsBC,CAAC,IAAIA,CAAC,CAACC,EAAF,KAASjB,MAApC,CAAJ;AAAZ;AAAjC,SAAjB;AACAkB,QAAAA,OAAO,CAACC,GAAR,CAAYT,IAAI,CAACI,QAAjB;AACH;;AACD,UAAIZ,QAAJ,EAAcA,QAAQ;AAEzB,KAZ+C;;AAahDkB,IAAAA,SAAS,EAAG;AACRpB,MAAAA,MADQ;AAERC,MAAAA;AAFQ;AAboC,GAAV,CAHM;AAAA;AAAA,QAGzCoB,oBAHyC;;AAqBhD,SACI,0CACA,oBAAC,KAAD;AAAO,IAAA,OAAO,EAAIpB,SAAS,GAAG,gBAAH,GAAsB,cAAjD;AAAkE,IAAA,QAAQ,MAA1E;AAA2E,IAAA,OAAO,EAC7E,oBAAC,MAAD;AAAQ,MAAA,EAAE,EAAC,KAAX;AAAiB,MAAA,KAAK,EAAC,KAAvB;AAA6B,MAAA,OAAO,EAAC,OAArC;AAA6C,MAAA,OAAO,EAAE,MAAKG,cAAc,CAAC,IAAD,CAAzE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OACA,oBAAC,IAAD;AAAM,MAAA,IAAI,EAAC,OAAX;AAAqB,MAAA,KAAK,EAAE;AAACkB,QAAAA,MAAM,EAAC;AAAR,OAA5B;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MADA,CADL;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IADA,EAOA,oBAAC,OAAD;AACI,IAAA,IAAI,EAAEnB,WADV;AAEI,IAAA,QAAQ,EAAI,MAAKC,cAAc,CAAC,KAAD,CAFnC;AAGI,IAAA,SAAS,EAAEiB,oBAHf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IAPA,CADJ;AAeH;;AAGD,MAAMd,oBAAoB,GAAGf,GAAI;;;;CAAjC;AAMA,MAAMc,uBAAuB,GAAGd,GAAI;;;;;;;;;;CAApC;AAYA,eAAeO,YAAf","sourcesContent":["import React, {useState} from 'react'\nimport gql from 'graphql-tag'\nimport {useMutation} from '@apollo/react-hooks'\nimport {Button, Confirm,  Icon, Popup} from 'semantic-ui-react'\nimport {FETCH_POSTS_QUERY} from '../util/graphql';\n\nfunction DeleteButton({postId, commentId, callback}){\n    const [confirmOpen, setConfirmOpen] = useState(false);\n    const mutation = commentId ? DELETE_COMMENT_MUTATION : DELETE_POST_MUTATION\n    const [deletePostOrMutation] = useMutation(mutation,{\n        update(proxy){\n            setConfirmOpen(false);\n            if(!commentId) {\n                const data = proxy.readQuery({\n                    query : FETCH_POSTS_QUERY\n                });\n                proxy.writeQuery({query: FETCH_POSTS_QUERY, data: {getPosts : [...data.getPosts.filter( p => p.id !== postId) ]}})\n                console.log(data.getPosts)\n            }\n            if (callback) callback();\n            \n        },\n        variables : { \n            postId,\n            commentId\n        }\n    })\n    return(\n        <>\n        <Popup content= { commentId ? 'Delete comment' : 'Delete post '}  inverted trigger={\n             <Button as='div' color='red' floated='right' onClick={()=> setConfirmOpen(true)}>\n             <Icon name='trash'   style={{margin:0}}/>\n         </Button>\n        }\n        />\n        <Confirm\n            open={confirmOpen}\n            onCancel = {()=> setConfirmOpen(false)}\n            onConfirm={deletePostOrMutation}\n        />\n        </>\n    )\n}\n\n\nconst DELETE_POST_MUTATION = gql`\nmutation deletePost($postId : ID!){\n    deletePost(postId: $postId)\n}\n`\n\nconst DELETE_COMMENT_MUTATION = gql`\nmutation deleteComment( $postId : ID!, $commentId: ID!){\n    deleteComment(postId : $postId , commentId : $commentId){\n        id\n        comments{\n            id username createdAt body\n        }\n        commentCount\n    }\n}\n`\n\nexport default DeleteButton"]},"metadata":{},"sourceType":"module"}